' Gambas class file

Public ControladorAplicacion As Controlador

Public Sub Form_Open()
  'formatear gridviews...
  
  Dim alu As New Alumnodao
  Dim curs As New Cursodao
  
  alu.gridFormatearColumnas(GridViewAlumno)
  curs.gridFormatearColumnas(GridViewCurso)
  ListBoxInforme.Add("Lista de Alumnos")
  ListBoxInforme.Add("Lista de Alumnos con los cursos que participan")
  ListBoxInforme.Add("Lista de Cursos")
  ListBoxInforme.Add("Lista de Cursos y Alumnos que lo conforman ")
  ListBoxInforme.Add("Expediente de Alumno determinado con lista de Cursos")
  ListBoxInforme.Add("Expediente de Curso determinado con lista de Alumnos")
  
End

'para el tema de dimensionado del formulario
Public Sub Form_Resize()
  
  IconPanelMenu.W = Me.w - IconPanelMenu.X
  IconPanelMenu.h = Me.H - IconPanelMenu.y - 10
  
  GridViewAlumno.w = Me.w - GridViewAlumno.X - IconPanelMenu.X - 30
  GridViewAlumno.h = Me.H - GridViewAlumno.y - IconPanelMenu.y - 10
  
  GridViewCurso.w = Me.w - GridViewcurso.X - IconPanelMenu.X - 30
  GridViewCurso.h = Me.H - GridViewCurso.y - IconPanelMenu.y - 10
  ListBoxInforme.h = Me.H - ListBoxInforme.y - IconPanelMenu.y - 10
  
End
'--------------------------------------------------------------------
'botones
'--------------------------------------------------------------------

Public Sub ToolButtonAnadir_Click()
  
  Dim nuevoalumno As New Alumnovo
  
  nuevoalumno.idAlumno = 0 'para que sea a a単adir
  ControladorAplicacion.falumno.TmpAlumno = nuevoalumno
  ControladorAplicacion.falumno.showmodal()
  
End

Public Sub ToolButtonEditar_Click()
  
  ControladorAplicacion.falumno.showmodal()
  
End

Public Sub ToolButtonAnadirCurso_Click()
  
  ControladorAplicacion.fcurso.showmodal()
  
End

Public Sub ToolButtonEditarCurso_Click()
  
  ControladorAplicacion.fcurso.showmodal()
  
End
'------------------------------------------------------------------
'IconPanelMenu
'------------------------------------------------------------------

Public Sub IconPanelMenu_Click()
  
  Select Case IconPanelMenu.Index
    Case 4
      'cambio de contrase単a
      LabelMensajeClave.text = "mensaje:"
      TextBoxUsuarioActual.text = ""
      TextBoxClaveActual.text = ""
      TextBoxClaveNueva.text = ""
      TextBoxClaveReescrita.text = ""
    Case 5
      'salir del programa
      Me.Close()
  End Select
  
End

'----------------------------------------------------------------------
'Zona de Administrador....
'----------------------------------------------------------------------
Public Sub ButtonCambiarClave_Click()
  
  If TextBoxClaveNueva.text = TextBoxClaveReescrita.text Then 
    
    If ControladorAplicacion.comprobarUsuarioPassword(TextBoxUsuarioActual.text, TextBoxClaveActual.text) Then 
      ControladorAplicacion.actualizarPassword(TextBoxUsuarioActual.text, TextBoxClaveNueva.text)
      LabelMensajeClave.text = "mensaje: ok se ma modificado la contrase単a"
      TextBoxUsuarioActual.text = ""
      TextBoxClaveActual.text = ""
      TextBoxClaveNueva.text = ""
      TextBoxClaveReescrita.text = ""
    Else
      LabelMensajeClave.text = "mensaje: no coincide la contrase単a Actual"
    Endif
    
  Else
    
    LabelMensajeClave.text = "mensaje: las clave Nueva no coincide con la Reescrita"
  Endif
  
End

Public Sub ToolButtonExpedienteCurso_Click()
  
  ControladorAplicacion.fExpCurso.ShowModal()
  
End

Public Sub ToolButtonExpediente_Click()
  
  ControladorAplicacion.fexpAlumno.ShowModal()
  
End
