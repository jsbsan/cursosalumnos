' Gambas class file

Public ControladorAplicacion As Controlador
Public TmpCurso As CursoVO

Public Sub Form_Open()
  
  Me.center
  
  If TmpCurso.idCurso = 0 Then
    'limpio los textbox
    limpio()
  Else
    'estoy editando
    rellena(TmpCurso)
  Endif
  
  TextBoxNombreCurso.SetFocus()
  
End

Public Sub ToolButtonAceptar_Click()
  
  TmpCurso.Nombre = TextBoxNombreCurso.Text
  TmpCurso.Detalle = TextAreaDetalle.Text
  
  If TmpCurso.idCurso <> 0 Then
    If ControladorAplicacion.ModificarIdCurso(TmpCurso) Then 
      'se ha a単adido bien el curso
      limpio()
      Me.Close()
      Return
    Else
      Message.Error(("Se ha producido un error al intentar a単adir el nuevo curso"))
      Return 
    Endif
  Endif
  
  If TmpCurso.idcurso = 0 And If ControladorAplicacion.anadirCurso(TmpCurso) Then 
    'se ha a単adido bien el nuevo alumno
    limpio()
    Me.Close()
    Return
  Else
    Message.Error(("Se ha producido un error al intentar a単adir el nuevo curso"))
    Return
  Endif
  
End

Public Sub limpio()
  
  TextAreaDetalle.text = ""
  TextBoxNombreCurso.text = ""
  
End

Public Sub rellena(micurso As CursoVO)
  
  TextBoxNombreCurso.text = micurso.Nombre
  TextAreaDetalle.text = micurso.Detalle
  
End
